<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Imputation of a Continuous or a Binary Variable From a Two-Level Regression Model
using <span class="pkg">lme4</span> or <span class="pkg">blme</span> — mice_imputation_2l_lmer • miceadds</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Imputation of a Continuous or a Binary Variable From a Two-Level Regression Model
using <span class="pkg">lme4</span> or <span class="pkg">blme</span> — mice_imputation_2l_lmer" />
<meta property="og:description" content="The function mice.impute.2l.continuous
imputes values of continuous variables with a linear
mixed effects model using lme4::lmer or
blme::blmer.
The lme4::lmer or
blme::blmer function is also
used for predictive mean matching where the match is based
on predicted values which contain the fixed and (sampled)
random effects. Binary variables can be imputed
from a two-level logistic regression model
fitted with the lme4::glmer or
blme::bglmer function.
See Snijders and Bosker (2012) and Zinn (2013) for details." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">miceadds</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Versions">3.16-vv</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/alexanderrobitzsch/miceadds/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Imputation of a Continuous or a Binary Variable From a Two-Level Regression Model
using <span class="pkg">lme4</span> or <span class="pkg">blme</span></h1>
    
    <div class="hidden name"><code>mice_imputation_2l_lmer.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function <code>mice.impute.2l.continuous</code>
imputes values of continuous variables with a linear
mixed effects model using <code><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lme4::lmer</a></code> or
<code><a href='https://rdrr.io/pkg/blme/man/blmer.html'>blme::blmer</a></code>.
The <code><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lme4::lmer</a></code> or
<code><a href='https://rdrr.io/pkg/blme/man/blmer.html'>blme::blmer</a></code> function is also
used for predictive mean matching where the match is based
on predicted values which contain the fixed and (sampled)
random effects. Binary variables can be imputed
from a two-level logistic regression model
fitted with the <code><a href='https://rdrr.io/pkg/lme4/man/glmer.html'>lme4::glmer</a></code> or
<code><a href='https://rdrr.io/pkg/blme/man/blmer.html'>blme::bglmer</a></code> function.
See Snijders and Bosker (2012) and Zinn (2013) for details.</p>
    </div>

    <pre class="usage"><span class='fu'>mice.impute.2l.continuous</span>(<span class='no'>y</span>, <span class='no'>ry</span>, <span class='no'>x</span>, <span class='no'>type</span>, <span class='kw'>intercept</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
    <span class='kw'>groupcenter.slope</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>draw.fixed</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>random.effects.shrinkage</span><span class='kw'>=</span><span class='fl'>1E-6</span>,
    <span class='kw'>glmer.warnings</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>blme_use</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>blme_args</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span> )

<span class='fu'>mice.impute.2l.pmm</span>(<span class='no'>y</span>, <span class='no'>ry</span>, <span class='no'>x</span>, <span class='no'>type</span>, <span class='kw'>intercept</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
    <span class='kw'>groupcenter.slope</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>draw.fixed</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>random.effects.shrinkage</span><span class='kw'>=</span><span class='fl'>1E-6</span>,
    <span class='kw'>glmer.warnings</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>donors</span><span class='kw'>=</span><span class='fl'>5</span>, <span class='kw'>match_sampled_pars</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
    <span class='kw'>blme_use</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>blme_args</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span> )

<span class='fu'>mice.impute.2l.binary</span>(<span class='no'>y</span>, <span class='no'>ry</span>, <span class='no'>x</span>, <span class='no'>type</span>, <span class='kw'>intercept</span><span class='kw'>=</span><span class='fl'>TRUE</span>,
    <span class='kw'>groupcenter.slope</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>draw.fixed</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>random.effects.shrinkage</span><span class='kw'>=</span><span class='fl'>1E-6</span>,
    <span class='kw'>glmer.warnings</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>blme_use</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>blme_args</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span> )</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>y</th>
      <td><p>Incomplete data vector of length <code>n</code></p></td>
    </tr>
    <tr>
      <th>ry</th>
      <td><p>Vector of missing data pattern (<code>FALSE</code> -- missing,
<code>TRUE</code> -- observed)</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>Matrix (<code>n</code> x <code>p</code>) of complete predictors.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>Type of predictor variable. The cluster identifier
has type <code>-2</code>, fixed effects predictors without a random slope
type <code>1</code> and predictors with fixed effects and random effects
have type <code>2</code>. If the cluster mean should be included for a covariate,
<code>3</code> should be chosen. The specification <code>4</code> includes the cluster mean,
the fixed effect and the random effect.</p></td>
    </tr>
    <tr>
      <th>intercept</th>
      <td><p>Optional logical indicating whether the intercept should be included.</p></td>
    </tr>
    <tr>
      <th>groupcenter.slope</th>
      <td><p>Optional logical indicating whether covariates
should be centered around group means</p></td>
    </tr>
    <tr>
      <th>draw.fixed</th>
      <td><p>Optional logical indicating whether fixed effects
parameter should be randomly drawn</p></td>
    </tr>
    <tr>
      <th>random.effects.shrinkage</th>
      <td><p>Shrinkage parameter for stabilizing the
covariance matrix of random effects</p></td>
    </tr>
    <tr>
      <th>glmer.warnings</th>
      <td><p>Optional logical indicating whether warnings from
<code>glmer</code> should be displayed</p></td>
    </tr>
    <tr>
      <th>blme_use</th>
      <td><p>Logical indicating whether the <span class="pkg">blme</span>
package should be used.</p></td>
    </tr>
    <tr>
      <th>blme_args</th>
      <td><p>(Prior) Arguments for <span class="pkg">blme</span>, see
<code><a href='https://rdrr.io/pkg/blme/man/blmer.html'>blme::blmer</a></code> and
<code><a href='https://rdrr.io/pkg/blme/man/bmerDist-class.html'>blme::bmerDist-class</a></code>.</p></td>
    </tr>
    <tr>
      <th>donors</th>
      <td><p>Number of donors used for predictive mean matching</p></td>
    </tr>
    <tr>
      <th>match_sampled_pars</th>
      <td><p>Logical indicating whether values of nearest
neighbors should also be sampled in pmm imputation.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments to be passed</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A vector of length <code>nmis=sum(!ry)</code> with imputed values.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Snijders, T. A. B., &amp; Bosker, R. J. (2012). <em>Multilevel analysis:
An introduction to basic and advanced multilevel modeling</em>.
Thousand Oaks, CA: Sage.</p>
<p>Zinn, S. (2013). <em>An imputation model for multilevel binary data</em>.
NEPS Working Paper No 31.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>See <code><a href='mice.impute.ml.lmer.html'>mice.impute.ml.lmer</a></code> for imputation for datasets with more than
two levels (e.g., three-level datasets or cross-classified datasets).</p>
<p>Variables at a higher level (e.g. at level 2) can be imputed using <code>2lonly</code>
functions, for example the
<code><a href='https://amices.org/mice/reference/mice.impute.2lonly.norm.html'>mice::mice.impute.2lonly.norm</a></code> function
in the <span class="pkg">mice</span> package or the general <code><a href='mice.impute.2lonly.function.html'>mice.impute.2lonly.function</a></code>
function in the <span class="pkg">miceadds</span> package which using an already defined imputation
method at level 1. If a level-2 variable for 3-level data should be imputed,
then <code><a href='mice.impute.ml.lmer.html'>mice.impute.ml.lmer</a></code> can also be used to impute this variable
with a two-level imputation model in which level 1 corresponds to the original
level-2 units and level 2 corresponds to the original level-3 units.</p>
<p>See <code><a href='https://amices.org/mice/reference/mice.impute.2l.norm.html'>mice::mice.impute.2l.norm</a></code> and
<code><a href='https://amices.org/mice/reference/mice.impute.2l.pan.html'>mice::mice.impute.2l.pan</a></code> for
imputation functions in the <span class="pkg">mice</span> package under fully conditional
specification for normally distributed variables. The function
<code><a href='https://amices.org/mice/reference/mice.impute.2l.norm.html'>mice::mice.impute.2l.norm</a></code> allows for
residual variances which are allowed to vary across groups while
<code><a href='https://amices.org/mice/reference/mice.impute.2l.pan.html'>mice::mice.impute.2l.pan</a></code> assumes
homogeneous residual variances.</p>
<p>The <span class="pkg">micemd</span> package provides further imputation methods for the <span class="pkg">mice</span>
package for imputing multilevel data with fully conditional specification. The
function <code><a href='https://rdrr.io/pkg/micemd/man/mice.impute.2l.jomo.html'>micemd::mice.impute.2l.jomo</a></code>
has similar functionality like <code><a href='https://amices.org/mice/reference/mice.impute.2l.pan.html'>mice::mice.impute.2l.pan</a></code>
and imputes normally distributed two-level data with a Bayesian MCMC approach,
but relies on the <span class="pkg">jomo</span> package instead of the <span class="pkg">pan</span> package.
The functions <code><a href='https://amices.org/mice/reference/mice.impute.2l.lmer.html'>mice::mice.impute.2l.lmer</a></code> and
<code><a href='https://rdrr.io/pkg/micemd/man/mice.impute.2l.glm.norm.html'>micemd::mice.impute.2l.glm.norm</a></code>
have similar functionality like <code>mice.impute.2l.continuous</code>
and imputes normally distributed two-level data. The function
<code>{micemd::mice.impute.2l.glm.bin}</code>
has similar functionality like <code>mice.impute.2l.binary</code>
and imputes binary two-level data.</p>
<p>The <span class="pkg">hmi</span> package imputes single-level and multilevel data and is also
based on fully conditional specification. The package relies on the
MCMC estimation implemented in the <span class="pkg">MCMCglmm</span> package. The imputation procedure
can be run with the <code>hmi::hmi</code> function.</p>
<p>See the <span class="pkg">pan</span> (<code><a href='https://rdrr.io/pkg/pan/man/pan.html'>pan::pan</a></code>)
and the <span class="pkg">jomo</span> (<code><a href='https://rdrr.io/pkg/jomo/man/jomo.html'>jomo::jomo</a></code>)
package for joint multilevel imputation. See
<code><a href='https://rdrr.io/pkg/mitml/man/panImpute.html'>mitml::panImpute</a></code> and
<code><a href='https://rdrr.io/pkg/mitml/man/jomoImpute.html'>mitml::jomoImpute</a></code> for
wrapper functions to these packages in the <span class="pkg">mitml</span>
package.</p>
<p>Imputation by chained equations can also be conducted in blocks of multivariate
conditional distributions since <span class="pkg">mice</span> 3.0.0 (see the <code>blocks</code>
argument in <code><a href='https://amices.org/mice/reference/mice.html'>mice::mice</a></code>). The
<code><a href='https://rdrr.io/pkg/mitml/man/panImpute.html'>mitml::panImpute</a></code> and
<code><a href='https://rdrr.io/pkg/mitml/man/jomoImpute.html'>mitml::jomoImpute</a></code> functions can be used
with <code><a href='https://amices.org/mice/reference/mice.html'>mice::mice</a></code> by specifying imputation
methods <code>"panImpute"</code>
(see <code><a href='https://amices.org/mice/reference/mice.impute.panImpute.html'>mice::mice.impute.panImpute</a></code>)) and
<code>"jomoImpute"</code>
(see <code><a href='https://amices.org/mice/reference/mice.impute.jomoImpute.html'>mice::mice.impute.jomoImpute</a></code>)).</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>#############################################################################</span>
<span class='co'># EXAMPLE 1: Imputation of a binary variable</span>
<span class='co'>#############################################################################</span>

<span class='co'>#--- simulate missing values</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>976</span>)
<span class='no'>G</span> <span class='kw'>&lt;-</span> <span class='fl'>30</span>        <span class='co'># number of groups</span>
<span class='no'>n</span> <span class='kw'>&lt;-</span> <span class='fl'>8</span>        <span class='co'># number of persons per group</span>
<span class='no'>iccx</span> <span class='kw'>&lt;-</span> <span class='fl'>.2</span>    <span class='co'># intra-class correlation X</span>
<span class='no'>iccy</span> <span class='kw'>&lt;-</span> <span class='fl'>.3</span>    <span class='co'># latent intra-class correlation binary outcome</span>
<span class='no'>bx</span> <span class='kw'>&lt;-</span> <span class='fl'>.4</span>    <span class='co'># regression coefficient</span>
<span class='no'>threshy</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>stats</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span>(<span class='fl'>.70</span>)  <span class='co'># threshold for y</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>( <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='no'>G</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>( <span class='no'>iccx</span>) ), <span class='kw'>each</span><span class='kw'>=</span><span class='no'>n</span> )  +
            <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>G</span>*<span class='no'>n</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>( <span class='fl'>1</span> - <span class='no'>iccx</span>) )
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='no'>bx</span> * <span class='no'>x</span> + <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>( <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>( <span class='no'>G</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>( <span class='no'>iccy</span>) ), <span class='kw'>each</span><span class='kw'>=</span><span class='no'>n</span> )  +
                <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='no'>G</span>*<span class='no'>n</span>, <span class='kw'>sd</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span>( <span class='fl'>1</span> - <span class='no'>iccy</span>) )
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span> * ( <span class='no'>y</span> <span class='kw'>&gt;</span> <span class='no'>threshy</span> )
<span class='no'>dat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>( <span class='kw'>group</span><span class='kw'>=</span><span class='fl'>100</span>+<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>:<span class='no'>G</span>, <span class='kw'>each</span><span class='kw'>=</span><span class='no'>n</span>), <span class='kw'>x</span><span class='kw'>=</span><span class='no'>x</span>, <span class='kw'>y</span><span class='kw'>=</span><span class='no'>y</span> )

<span class='co'>#* create some missings</span>
<span class='no'>dat1</span> <span class='kw'>&lt;-</span> <span class='no'>dat</span>
<span class='no'>dat1</span>[ <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>( <span class='fl'>1</span>, <span class='no'>G</span>*<span class='no'>n</span>, <span class='fl'>3</span> ),<span class='st'>"y"</span> ]  <span class='kw'>&lt;-</span> <span class='fl'>NA</span>
<span class='no'>dat1</span>[ <span class='no'>dat1</span>$<span class='no'>group</span><span class='kw'>==</span><span class='fl'>2</span>, <span class='st'>"y"</span> ] <span class='kw'>&lt;-</span> <span class='fl'>NA</span>

<span class='co'>#--- prepare imputation in mice</span>
<span class='no'>vars</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>dat1</span>)
<span class='no'>V</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>vars</span>)
<span class='co'>#* predictor matrix</span>
<span class='no'>predmat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>( <span class='fl'>0</span>, <span class='kw'>nrow</span><span class='kw'>=</span><span class='no'>V</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>V</span>)
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span>(<span class='no'>predmat</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>predmat</span>) <span class='kw'>&lt;-</span> <span class='no'>vars</span>
<span class='no'>predmat</span>[<span class='st'>"y"</span>, ] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>2</span>,<span class='fl'>2</span>,<span class='fl'>0</span>)
<span class='co'>#* imputation methods</span>
<span class='no'>impmeth</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='st'>""</span>,<span class='no'>V</span>)
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>impmeth</span>) <span class='kw'>&lt;-</span> <span class='no'>vars</span>
<span class='no'>impmeth</span>[<span class='st'>"y"</span>] <span class='kw'>&lt;-</span> <span class='st'>"2l.binary"</span>

<span class='co'>#** imputation with logistic regression ('2l.binary')</span>
<span class='no'>imp1</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mice</span><span class='kw ns'>::</span><span class='fu'><a href='https://amices.org/mice/reference/mice.html'>mice</a></span>( <span class='kw'>data</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>dat1</span>), <span class='kw'>method</span><span class='kw'>=</span><span class='no'>impmeth</span>,
                <span class='kw'>predictorMatrix</span><span class='kw'>=</span><span class='no'>predmat</span>, <span class='kw'>maxit</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>m</span><span class='kw'>=</span><span class='fl'>5</span> )

<span class='co'>#** imputation with predictive mean matching ('2l.pmm')</span>
<span class='no'>impmeth</span>[<span class='st'>"y"</span>] <span class='kw'>&lt;-</span> <span class='st'>"2l.pmm"</span>
<span class='no'>imp2</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mice</span><span class='kw ns'>::</span><span class='fu'><a href='https://amices.org/mice/reference/mice.html'>mice</a></span>( <span class='kw'>data</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>dat1</span>), <span class='kw'>method</span><span class='kw'>=</span><span class='no'>impmeth</span>,
                <span class='kw'>predictorMatrix</span><span class='kw'>=</span><span class='no'>predmat</span>, <span class='kw'>maxit</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>m</span><span class='kw'>=</span><span class='fl'>5</span> )

<span class='co'>#** imputation with logistic regression using blme package</span>
<span class='no'>blme_args</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>( <span class='st'>"cov.prior"</span><span class='kw'>=</span><span class='st'>"invwishart"</span>)
<span class='no'>imp3</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>mice</span><span class='kw ns'>::</span><span class='fu'><a href='https://amices.org/mice/reference/mice.html'>mice</a></span>( <span class='kw'>data</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>dat1</span>), <span class='kw'>method</span><span class='kw'>=</span><span class='no'>impmeth</span>,
                <span class='kw'>predictorMatrix</span><span class='kw'>=</span><span class='no'>predmat</span>, <span class='kw'>maxit</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>m</span><span class='kw'>=</span><span class='fl'>5</span>,
                <span class='kw'>blme_use</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>blme_args</span><span class='kw'>=</span><span class='no'>blme_args</span> )
}</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


